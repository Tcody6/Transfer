import numpy as np
import networkx as net
import pandas as pd
import matplotlib.pyplot as plt

print("start")
players = pd.read_csv("advanced.csv")

all = pd.Series(players['name'].unique())

all = all.to_dict()
print("loading")
adj = np.loadtxt("2014.csv")
graph2014 = net.from_numpy_array(adj)

adj = np.loadtxt("2015.csv")
graph2015 = net.from_numpy_array(adj)
print("2016")
adj = np.loadtxt("2016.csv")
graph2016 = net.from_numpy_array(adj)
print("2017")
adj = np.loadtxt("2017.csv")
graph2017 = net.from_numpy_array(adj)
print("2018")
adj = np.loadtxt("2018.csv")
graph2018 = net.from_numpy_array(adj)
print("2019")
adj = np.loadtxt("2019.csv")
graph2019 = net.from_numpy_array(adj)
print("2020")
adj = np.loadtxt("2020.csv")
graph2020 = net.from_numpy_array(adj)
print("2021")
adj = np.loadtxt("2021.csv")
graph2021 = net.from_numpy_array(adj)
print("2022")
adj = np.loadtxt("2022.csv")
graph2022 = net.from_numpy_array(adj)

print("relabel in process")
graph2014 = net.relabel.relabel_nodes(graph2014, all)
graph2015 = net.relabel.relabel_nodes(graph2015, all)
graph2016 = net.relabel.relabel_nodes(graph2016, all)
graph2017 = net.relabel.relabel_nodes(graph2017, all)
graph2018 = net.relabel.relabel_nodes(graph2018, all)
graph2019 = net.relabel.relabel_nodes(graph2019, all)
graph2020 = net.relabel.relabel_nodes(graph2020, all)
graph2021 = net.relabel.relabel_nodes(graph2021, all)
graph2022 = net.relabel.relabel_nodes(graph2022, all)

print("convert to undirected")
graph2014.to_undirected()
graph2015.to_undirected()
graph2016.to_undirected()
graph2017.to_undirected()
graph2018.to_undirected()
graph2019.to_undirected()
graph2020.to_undirected()
graph2021.to_undirected()
graph2022.to_undirected()

print("selfloop removal")
graph2014.remove_edges_from(net.selfloop_edges(graph2014))
graph2015.remove_edges_from(net.selfloop_edges(graph2015))
graph2016.remove_edges_from(net.selfloop_edges(graph2016))
graph2017.remove_edges_from(net.selfloop_edges(graph2017))
graph2018.remove_edges_from(net.selfloop_edges(graph2018))
graph2019.remove_edges_from(net.selfloop_edges(graph2019))
graph2020.remove_edges_from(net.selfloop_edges(graph2020))
graph2021.remove_edges_from(net.selfloop_edges(graph2021))
graph2022.remove_edges_from(net.selfloop_edges(graph2022))

print("saving")
net.write_gexf(graph2014, "graph2014.gexf")
net.write_gexf(graph2015, "graph2015.gexf")
net.write_gexf(graph2016, "graph2016.gexf")
net.write_gexf(graph2017, "graph2017.gexf")
net.write_gexf(graph2018, "graph2018.gexf")
net.write_gexf(graph2019, "graph2019.gexf")
net.write_gexf(graph2020, "graph2020.gexf")
net.write_gexf(graph2021, "graph2021.gexf")
net.write_gexf(graph2022, "graph2022.gexf")